# 服务器信息监控开发方案

根据您的需求，我将为您开发一套完整的服务器信息监控系统，支持实时数据展示和历史趋势分析。该方案基于现有的 SSH 连接能力，无需在目标服务器上安装任何 Agent。

## 1. 系统架构

### 1.1 核心逻辑
*   **实时监控**：前端轮询或按需请求，后端通过 SSH 执行 Linux 命令（如 `top`, `free`, `df`）获取瞬时状态。
*   **趋势监控**：后端使用 Spring Task 定时任务（每 5 分钟），轮询所有服务器，采集 CPU、内存、网络流量数据并存入数据库。
*   **前端展示**：使用 ECharts 绘制仪表盘（实时）和折线图（趋势）。

## 2. 数据库设计 (新增表)

将创建 `sys_ops_monitor_log` 表用于存储历史监控数据：
*   `id`: 主键
*   `server_id`: 关联服务器
*   `cpu_usage`: CPU 使用率 (%)
*   `memory_usage`: 内存使用率 (%)
*   `disk_usage`: 磁盘使用率 (%)
*   `net_tx_rate`: 网络发送速率 (KB/s)
*   `net_rx_rate`: 网络接收速率 (KB/s)
*   `create_time`: 采集时间

## 3. 后端开发 (Java)

1.  **实体类与 Mapper**：创建 `OpsMonitorLog` 实体及对应的 MyBatis Mapper。
2.  **Service 层 (`OpsMonitorService`)**：
    *   `collectRealtime(Long serverId)`: 执行 SSH 命令获取当前快照。
    *   `collectTrend()`: 定时任务逻辑，批量采集并入库。
3.  **Controller 层 (`OpsMonitorController`)**：
    *   `GET /monitor/realtime/{serverId}`: 获取实时数据。
    *   `GET /monitor/trend/{serverId}`: 获取历史趋势数据（支持 24h/7d 参数）。
4.  **定时任务**: 配置 `@Scheduled` 任务，自动采集数据。

## 4. 前端开发 (Vue + ECharts)

1.  **新页面**: `views/ops/monitor/index.vue`
    *   **布局**: 左侧服务器列表（复用之前的样式），右侧监控面板。
    *   **顶部**: 关键指标卡片（CPU、内存、磁盘、网络）。
    *   **中部**: 实时仪表盘 (Gauge Charts)。
    *   **底部**: 历史趋势折线图 (Line Charts)，支持时间范围切换。
2.  **路由**: 在 `router/index.js` 添加 `/ops/monitor`。
3.  **菜单**: 添加“信息监控”菜单项。

## 5. 执行步骤

1.  **数据库变更**: 创建监控日志表。
2.  **后端实现**: 生成代码、编写 SSH 解析逻辑、实现定时任务。
3.  **前端实现**: 引入 ECharts，开发监控仪表盘页面。
4.  **联调测试**: 验证数据采集准确性和图表展示效果。

我将从数据库设计开始执行此计划。
